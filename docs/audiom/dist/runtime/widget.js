System.register(["jimu-core/emotion","jimu-core","jimu-arcgis","esri/layers/FeatureLayer"],function(e,t){var s={},i={},r={},o={};return{setters:[function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){i.DataSourceManager=e.DataSourceManager,i.React=e.React},function(e){r.JimuMapViewComponent=e.JimuMapViewComponent},function(e){o.default=e.default}],execute:function(){e((()=>{var e={244:e=>{"use strict";e.exports=i},386:e=>{"use strict";e.exports=s},633:e=>{"use strict";e.exports=o},686:e=>{"use strict";e.exports=r}},t={};function a(s){var i=t[s];if(void 0!==i)return i.exports;var r=t[s]={exports:{}};return e[s](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.p="";var n={};return a.p=window.jimuConfig.baseUrl,(()=>{"use strict";a.r(n),a.d(n,{__set_webpack_public_path__:()=>y,default:()=>v,toEmbedConfig:()=>f});var e,t=a(386),s=a(244),i=a(686);!function(e){e.Kilometers="km",e.Meters="m",e.Miles="mi",e.Feet="ft"}(e||(e={}));const r={[e.Meters]:1,[e.Kilometers]:1e3,[e.Miles]:1609.34,[e.Feet]:.3048};class o{constructor(e,t){if(e<=0)throw new Error("Step size value must be positive");this.value=e,this.unit=t}static Kilometers(t){return new o(t,e.Kilometers)}static Meters(t){return new o(t,e.Meters)}static Miles(t){return new o(t,e.Miles)}static Feet(t){return new o(t,e.Feet)}static parse(t){const s=t.match(/^(\d+(?:\.\d+)?)(km|m|mi|ft)?$/);if(!s)throw new Error(`Invalid step size format: ${t}`);const i=parseFloat(s[1]),r=s[2]||e.Meters;return new o(i,r)}toString(){return`${this.value}${this.unit}`}convertTo(e){if(this.unit===e)return new o(this.value,this.unit);const t=this.value*r[this.unit];return new o(t/r[e],e)}toMeters(){return this.convertTo(e.Meters)}toKilometers(){return this.convertTo(e.Kilometers)}toMiles(){return this.convertTo(e.Miles)}toFeet(){return this.convertTo(e.Feet)}}var u,c;!function(e){e.Travel="travel",e.Heatmap="heatmap",e.Indoor="indoor"}(u||(u={})),function(e){e.OSM="osm",e.TDEI="TDEI",e.ESRI="esri",e.GeoJSON="geojson"}(c||(c={}));class l{constructor(e){this.source=e.source,this.type=e.type,this.mapType=e.mapType,this.name=e.name,this.url=e.url,this.rules=e.rules,this.additionalParams=e.additionalParams}static fromName(e){return new l({source:e})}static fromGeoJsonUrl(e,t){return new l({source:e,type:c.GeoJSON,name:t})}static fromEsri(e){return new l({source:e.source,type:c.ESRI,url:e.url,name:e.name,mapType:e.mapType,rules:e.rules})}toQueryParams(){const e={};return this.type&&(e[`${this.source}.type`]=this.type),this.mapType&&(e[`${this.source}.mapType`]=this.mapType),this.name&&(e[`${this.source}.name`]=this.name),this.url&&(e[`${this.source}.url`]=this.url),this.rules&&(e[`${this.source}.rules`]=this.rules),this.additionalParams&&Object.entries(this.additionalParams).forEach(([t,s])=>{e[`${this.source}.${t}`]=String(s)}),e}}class h{constructor(e){this.embedId=e.embedId,this.apiKey=e.apiKey,e.sources&&(this.sources=e.sources.map(e=>"string"==typeof e?l.fromName(e):new l(e))),this.center=e.center,this.latitude=e.latitude,this.longitude=e.longitude,this.zoom=e.zoom,this.soundpack=e.soundpack,this.demo=e.demo,this.title=e.title,this.showVisualMap=e.showVisualMap,this.heading=e.heading,this.showHeading=e.showHeading,e.stepSize&&(this.stepSize="string"==typeof e.stepSize?o.parse(e.stepSize):e.stepSize),this.additionalParams=e.additionalParams}static dynamic(e){return new h(Object.assign(Object.assign({},e),{embedId:"dynamic"}))}static static(e,t,s){return new h(Object.assign({embedId:e,apiKey:t},s))}toQueryParams(){const e={};if(e.apiKey=this.apiKey,this.sources&&this.sources.length>0){const t=this.sources.map(e=>e.source).join(",");e["sources"]=t,this.sources.forEach(t=>{const s=t.toQueryParams();Object.assign(e,s)})}return this.center?e.center=`${this.center[0]},${this.center[1]}`:(void 0!==this.latitude&&(e.latitude=String(this.latitude)),void 0!==this.longitude&&(e.longitude=String(this.longitude))),void 0!==this.zoom&&(e.zoom=String(this.zoom)),this.soundpack&&(e.soundpack=this.soundpack),void 0!==this.demo&&(e.demo=String(this.demo)),this.title&&(e.title=this.title),void 0!==this.showVisualMap&&(e.showVisualMap=String(this.showVisualMap)),void 0!==this.heading&&(e.heading=String(this.heading)),void 0!==this.showHeading&&(e.showHeading=String(this.showHeading)),this.stepSize&&(e.stepsize=this.stepSize.toString()),this.additionalParams&&Object.entries(this.additionalParams).forEach(([t,s])=>{e[t]=String(s)}),e}toUrl(e=h.defaultBaseURL){const t=this.toQueryParams(),s=Object.entries(t).map(([e,t])=>`${e}=${t}`).join("&");return`${e}/embed/${this.embedId}?${s}`}toUrlWithBase(e){return this.toUrl(e)}}h.defaultBaseURL="https://audiom-staging.herokuapp.com";var d=a(633);const{useState:p,useRef:m}=s.React,g=s.DataSourceManager.getInstance().getDataSources();function f(e){var t,s,i,r;return h.dynamic({apiKey:e.apiKey||"",sources:[],center:[e.centerLongitude||0,e.centerLatitude||0],showVisualMap:null===(t=e.showVisualMap)||void 0===t||t,showHeading:null!==(s=e.showHeading)&&void 0!==s&&s,zoom:null!==(i=e.zoom)&&void 0!==i?i:10,heading:e.heading,stepSize:o.Kilometers(null!==(r=e.stepSize)&&void 0!==r?r:1)})}Object.entries(g).forEach(([e,t])=>{console.log("DataSource ID:",e),console.log("DataSource Type:",t.type)});const v=e=>{var s,r,o,a;const[n,c]=p(),h=m(!1),g=f(e.config);let v=[];if(null===(s=e.config)||void 0===s?void 0:s.sourceUrl){const t=l.fromEsri({name:"Units",source:"units",url:e.config.sourceUrl,mapType:u.Indoor,rules:(null===(r=e.config)||void 0===r?void 0:r.rulesFileUrl)||""});v.push(t)}g.sources=v;const y=g.toUrl((null===(o=e.config)||void 0===o?void 0:o.baseUrl)||"https://audiom-staging.herokuapp.com"),w={1:"BAE9BBC5-D74F-4B7A-9904-9763AE70CCF2",2:"6EA20B7B-4EFD-4B2C-993F-47E12AE0C776",3:"6DE9F705-DA11-4195-84DB-3AB0089D7992"},S=[1,2,3].flatMap(e=>g.sources.filter(e=>"Units"===e.name).map(t=>{let s="";if("Units"===t.name){s=`LEVEL_ID = '{${w[e]}}'`}else"Levels"===t.name&&(s=`LEVEL_NUMBER = ${e}`);return new d.default({url:t.url,title:`Level ${e}`,popupEnabled:!0,opacity:.8,definitionExpression:s,visible:1===e})}));return(0,t.jsxs)("div",{className:"jimu-widget",children:[e.useMapWidgetIds&&1===e.useMapWidgetIds.length&&(0,t.jsx)(i.JimuMapViewComponent,{useMapWidgetId:null===(a=e.useMapWidgetIds)||void 0===a?void 0:a[0],onActiveViewChange:e=>{e&&!h.current&&(c(e),S.forEach(t=>{e.view.map.add(t)}),h.current=!0)}}),(0,t.jsx)("iframe",{name:"audiom",src:y,width:"100%",height:"100%",title:"ESRI Map",style:{border:"0px"}})]})};function y(e){a.p=e}})(),n})())}}});