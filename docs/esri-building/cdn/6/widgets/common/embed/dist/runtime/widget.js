System.register(["jimu-core/emotion","jimu-core","jimu-core/react","jimu-ui"],function(e,t){var s={},o={},i={},r={};return{setters:[function(e){s.jsx=e.jsx,s.jsxs=e.jsxs},function(e){o.AppMode=e.AppMode,o.BaseVersionManager=e.BaseVersionManager,o.ExpressionPartType=e.ExpressionPartType,o.LayoutParentType=e.LayoutParentType,o.React=e.React,o.ViewVisibilityContext=e.ViewVisibilityContext,o.WIDGET_PREFIX_FOR_A11Y_SKIP=e.WIDGET_PREFIX_FOR_A11Y_SKIP,o.appActions=e.appActions,o.classNames=e.classNames,o.css=e.css,o.esri=e.esri,o.getAppStore=e.getAppStore,o.queryString=e.queryString,o.urlUtils=e.urlUtils,o.utils=e.utils},function(e){i.Fragment=e.Fragment},function(e){r.Alert=e.Alert,r.AlertButton=e.AlertButton,r.DynamicUrlResolver=e.DynamicUrlResolver,r.Paper=e.Paper,r.WidgetPlaceholder=e.WidgetPlaceholder}],execute:function(){e((()=>{var e={14321:e=>{"use strict";e.exports=r},67386:e=>{"use strict";e.exports=s},68972:e=>{"use strict";e.exports=i},79244:e=>{"use strict";e.exports=o},87085:e=>{e.exports='<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 20 20"><path fill="#000" d="M11.483 8.65a.52.52 0 0 0-.345-.632.486.486 0 0 0-.598.364l-2.023 7.969a.52.52 0 0 0 .345.631c.26.074.529-.09.598-.364zM7.36 8.139a.473.473 0 0 1 0 .67L3.651 12.5l3.71 3.69a.473.473 0 0 1 0 .671.48.48 0 0 1-.675 0L2.64 12.835a.473.473 0 0 1 0-.67l4.046-4.026a.48.48 0 0 1 .674 0M12.64 8.139a.473.473 0 0 0 0 .67l3.709 3.691-3.71 3.69a.473.473 0 0 0 0 .671.48.48 0 0 0 .675 0l4.046-4.026a.473.473 0 0 0 0-.67l-4.046-4.026a.48.48 0 0 0-.674 0"></path><path fill="#000" fill-rule="evenodd" d="M20 2a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2zM2 1h16a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1" clip-rule="evenodd"></path><path fill="#000" d="M1 5h18v1H1zM3 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2M6 4a1 1 0 1 0 0-2 1 1 0 0 0 0 2M10 3a1 1 0 1 1-2 0 1 1 0 0 1 2 0"></path></svg>'}},t={};function n(s){var o=t[s];if(void 0!==o)return o.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="";var a={};return n.p=window.jimuConfig.baseUrl,(()=>{"use strict";n.r(a),n.d(a,{__set_webpack_public_path__:()=>w,default:()=>b});var e,t=n(67386),s=n(79244),o=n(68972),i=n(14321);function r(e,t){const{width:o,height:i}=t;return s.css`
    &.widget-embed {
      width: 100%;
      height: 100%;
      position: relative;
      ${o&&"overflow-x: auto"};
      ${i&&"overflow-y: auto"};
      .embed-iframe {
        border: 0;
        border-radius: inherit;
      }
      .load-err-mask {
        position: absolute;
        left: 0;
        right: 0;
        top: 0;
        bottom: 0;
        background-color: ${e.ref.palette.white};
        .mask-content{
          position: absolute;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
        }
        .truncate-two {
          overflow: hidden;
          text-overflow: ellipsis;
          display: -webkit-box;
          -webkit-line-clamp: 2;
          line-clamp: 2;
          -webkit-box-orient: vertical;
          word-break: break-all;
        }
      }
      .bottom-alert {
        position: absolute;
        bottom: 0;
      }
    }
  `}!function(e){e.Url="url",e.Code="code"}(e||(e={}));const l={_widgetLabel:"Embed",embedHint:"Embed by URL or code",unSupportUrl:"It's not a valid URL.",unSupportIframeUrl:"Sorry, this content could not be embedded. It may restrict the embedding of content from other sites.",maxLimitTips:"HTML code exceeds the maximum character limit.",unsupportedHtmlTips:"Oops! The embedded content cannot display due to an unsupported HTML format.",embedTitle:"Embed widget, embedded content"};var c=n(87085),d=n.n(c);const p=e=>{try{let t=JSON.stringify(e);return t=encodeURIComponent(t),t}catch(e){console.error(e)}};class u extends s.BaseVersionManager{constructor(){super(...arguments),this.versions=[{version:"1.0.0",description:"The first release.",upgrader:t=>{var s,o;const i=null===(s=null==t?void 0:t.functionConfig)||void 0===s?void 0:s.embedType,r=null===(o=null==t?void 0:t.functionConfig)||void 0===o?void 0:o.content;return i?(t=t.set("embedType",i),t=i===e.Url?t.set("staticUrl",r):t.set("embedCode",r)):t=t.set("embedType",e.Url),t=t.without("functionConfig")}},{version:"1.4.0",description:"Enhance the URL editor.",upgrader:(t,o)=>{var i,r;const n=null==t?void 0:t.embedType,a=null==t?void 0:t.expression,l=null==t?void 0:t.staticUrl,c=null===(r=null===(i=(0,s.getAppStore)().getState())||void 0===i?void 0:i.appConfig)||void 0===r?void 0:r.widgets[o],d=null==c?void 0:c.useDataSourcesEnabled;if((null==a?void 0:a.name)&&(t=t.set("enableLabel",!0).set("label",a.name)),n===e.Url&&l){const e=`<p>${l}</p>`;t=t.set("expression",e)}else if(n===e.Url&&a&&!1!==d){const e=(e=>{let t="";const{parts:o}=e;if(o.length>0){let e=!1;const i={name:"",parts:[]};let r=0,n=0,a="";o.forEach(o=>{const{type:l,dataSourceId:c,exp:d}=o;if(e){if(i.name+=d,i.parts.push(o),c&&(a=c),l===s.ExpressionPartType.Operator&&"("===d)r++;else if(l===s.ExpressionPartType.Operator&&")"===d&&(n++,n===r)){r=0,n=0,e=!1;const o=s.utils.getUUID(),l=document&&document.createElement("exp");l.setAttribute("data-uniqueid",o),l.setAttribute("data-dsid",a),l.setAttribute("data-expression",p(i)),l.innerHTML=i.name,t+=l.outerHTML}return!1}if(l===s.ExpressionPartType.Field){const e=s.utils.getUUID(),i=document&&document.createElement("exp");i.setAttribute("data-uniqueid",e),i.setAttribute("data-dsid",c),i.setAttribute("data-expression",p({name:d,parts:[o]})),i.innerHTML=d,t+=i.outerHTML}else l===s.ExpressionPartType.String?t+=d.replace(/(^['|"]*|['|"]*$)/g,""):l===s.ExpressionPartType.Number?t+=d:l===s.ExpressionPartType.Function&&(e=!0,i.name=d,i.parts.push(o))})}return`<p>${t}</p>`})(a);t=t.set("expression",e)}return t}},{version:"1.7.0",description:"Update some wrong config",upgrader:(e,t)=>{const s=null==e?void 0:e.expression;return e=e.set("expression",(e=>{const t=null==e?void 0:e.match(/\<exp((?!\<exp).)+\<\/exp\>/gim);let s=e;return t&&t.forEach(e=>{var t,o;const i=null===(t=e.match(/<exp[^>]*>([\s\S]*?)<\/exp>/))||void 0===t?void 0:t[1],r=i.match(/<span[^>]*>([\s\S]*?)<\/span>/),n=r&&(null===(o=i.match(/<span[^>]*>([\s\S]*?)<\/span>/))||void 0===o?void 0:o[1]);(!i.trim()||r&&!n.trim())&&(s=s.replace(e,""))}),s})(s)),e}}]}}const h=new u,m=e=>{let t="";const o=/<iframe\s+[^>]*src=['"]([^'"]+)[^>](.*)/gi,i=/<blockquote [^>]*data-instgrm-permalink=['"]([^'"]+)[^>]*>(.*)<\/blockquote>/gi,r=/<a [^>]*href=['"]([^'"]+)[^>]*>/gi,n=/<blockquote [^>]*data-theme=['"]([^'"]+)[^>]*>(.*)<\/blockquote>/gi,a=/<blockquote [^>]*data-lang=['"]([^'"]+)[^>]*>(.*)<\/blockquote>/gi,l=/<a [^>]*data-theme=['"]([^'"]+)[^>]*>(.*)<\/a>/gi,c=/<a [^>]*data-lang=['"]([^'"]+)[^>]*>(.*)<\/a>/gi,d=["twitter.com","www.twitter.com"];o.test(e)?e.replace(o,(e,s)=>(t=s,e)):i.test(e)?e.replace(i,(e,s)=>{const o=s.substr(0,s.indexOf("?"));return t=`${o}embed`,e}):/<blockquote class="twitter-tweet"(.*)<\/blockquote>/gi.test(e)?e.replace(r,(o,i)=>{const r=s.urlUtils.getUrlHost(i);if(d.includes(r)){const s=i.substring(i.lastIndexOf("/")+1).replace(/[?].*$/,""),o=n.exec(e),r=a.exec(e);let l,c;(null==o?void 0:o.length)>1&&(l=o[1]),(null==r?void 0:r.length)>1&&(c=r[1]),t=`https://platform.twitter.com/embed/Tweet.html?id=${s}${l?`&theme=${l}`:""}${c?`&lang=${c}`:""}`}return o}):/<a class="twitter-timeline" [^>]*href=['"]([^'"]+)[^>]*>(.*)<\/a>/gi.test(e)&&e.replace(r,(o,i)=>{const r=s.urlUtils.getUrlHost(i);if(d.includes(r)){const s=i.substring(i.lastIndexOf("/")+1).replace(/[?].*$/,""),o=l.exec(e),r=c.exec(e);let n,a;(null==o?void 0:o.length)>1&&(n=o[1]),(null==r?void 0:r.length)>1&&(a=r[1]);t=`https://syndication.twitter.com/srv/timeline-profile/screen-name/${s}${n||a?"?":""}${n?`&theme=${n}`:""}${a?`&lang=${a}`:""}`}return o});const p=decodeURI(t).trim().toLocaleLowerCase();return(p.startsWith("javascript:")||p.startsWith("data:")||p.startsWith("vbscript:"))&&(t=""),t},f=new(0,s.esri.Sanitizer),v=[".arcgis.com"];class g extends s.React.PureComponent{constructor(o){super(o),this.injectFontToIframe=(e,t)=>{const s=e.createElement("link");s.id="embed-inject-font",s.rel="stylesheet",s.type="text/css",s.href=t,e.head.appendChild(s)},this.updateIframeFont=e=>{var t,o,i;if(this.ifr){const r=(null===(t=this.ifr)||void 0===t?void 0:t.contentDocument)||(null===(i=null===(o=this.ifr)||void 0===o?void 0:o.contentWindow)||void 0===i?void 0:i.document);if(!r)return;const n=r.querySelector("body"),a=`${s.urlUtils.getFixedRootPath()}jimu-theme/base/assets/fonts/avenir/fonts.css`;n&&(n.style.fontFamily=e);const l=r.getElementById("embed-inject-font");l&&l.remove(),"Avenir Next"===e&&this.injectFontToIframe(r,a)}},this.removeIframeFont=()=>{var e,t,s;if(this.ifr){const o=(null===(e=this.ifr)||void 0===e?void 0:e.contentDocument)||(null===(s=null===(t=this.ifr)||void 0===t?void 0:t.contentWindow)||void 0===s?void 0:s.document);if(!o)return;const i=o.querySelector("body");i&&i.style.removeProperty("font-family");const r=o.getElementById("embed-inject-font");r&&r.remove()}},this.checkAndLoadByType=()=>{const{config:t}=this.props,{embedType:s}=t,{content:o}=this.state;if(s===e.Url){const e=this.processUrl(o);this.checkUrl(e).then(e=>{e&&this.loadContent()})}else this.loadContent()},this.getSectionIdWhenParentIsView=(e,t)=>{var o;const i=e.mainSizeMode,r=null===(o=e.layouts)||void 0===o?void 0:o[t];let n;const a=t=>{var o,r,l,c,d,p,u,h;if(t)if((null===(o=null==t?void 0:t.parent)||void 0===o?void 0:o.type)===s.LayoutParentType.View){const s=null===(r=t.parent)||void 0===r?void 0:r.id,o=null===(l=e.views)||void 0===l?void 0:l[s];n=null==o?void 0:o.parent}else{const s=null===(c=null==t?void 0:t.parent)||void 0===c?void 0:c.id,o=e.widgets[s],r=null===(u=null===(p=null===(d=null==o?void 0:o.parent)||void 0===d?void 0:d[i])||void 0===p?void 0:p[0])||void 0===u?void 0:u.layoutId,n=null===(h=e.layouts)||void 0===h?void 0:h[r];a(n)}};return a(r),n},this.reloadContentInView=e=>{const{sectionNavInfos:t,layoutId:o}=this.props;if(this.needLoadContentInView&&t&&e!==t){const i=[];for(const s in t){t[s]!==(null==e?void 0:e[s])&&i.push(s)}const r=(0,s.getAppStore)().getState(),n=null==r?void 0:r.appConfig,a=this.getSectionIdWhenParentIsView(n,o);i.includes(a)&&this.checkAndLoadByType()}},this.autoRefreshHandler=t=>{const{useSrcdoc:s}=this.state,{config:o}=this.props,{embedType:i,autoRefresh:r,autoInterval:n=1}=o;if(!this.refreshTimer&&r){const t=setInterval(()=>{if(this.ifr)if(i===e.Code&&s){const e=this.ifr.srcdoc;this.ifr.srcdoc=e}else{const e=this.ifr.src;this.ifr.src="",setTimeout(()=>{this.ifr&&(this.ifr.src=e)},100)}},60*n*1e3);this.refreshTimer=t}else this.refreshTimer&&!r&&(clearInterval(this.refreshTimer),this.refreshTimer=null);if(t&&r){this.refreshTimer&&clearInterval(this.refreshTimer);const t=setInterval(()=>{if(this.ifr)if(i===e.Code&&s){const e=this.ifr.srcdoc;this.ifr.srcdoc=e}else{const e=this.ifr.src;this.ifr.src="",setTimeout(()=>{this.ifr&&(this.ifr.src=e)},100)}},60*n*1e3);this.refreshTimer=t}},this.iframeOnLoad=()=>{var t;const{useSrcdoc:s}=this.state,{config:o,theme:i}=this.props,{embedType:r,honorThemeFont:n}=o,a=r===e.Code;if(this.setState({isLoading:!1}),a&&n&&s){const e=null===(t=i.ref.typeface)||void 0===t?void 0:t.fontFamily;e&&this.updateIframeFont(e)}},this.checkSafeDomain=e=>{let t=!1;if(!e)return t;const o=(0,s.getAppStore)().getState(),i=null==o?void 0:o.portalSelf;let r=null==i?void 0:i.portalHostname;(null==r?void 0:r.includes("/"))&&(r=r.split("/")[0]);const n=[...v];r&&n.push(r);let a="";if(e.includes("https://")&&(a=e.substring(8).split("/")[0]),"arcgis.com"===a)return!0;for(const e of n)if(a.includes(e)){t=!0;break}return t},this.processUrl=(t,o)=>{var i,r,n;if(!t)return t;const{config:a}=this.props,{embedType:l}=a,c=t.toLowerCase();if(/https:\/\/vimeo\.com\/.*/.test(c)){const e=(t=s.urlUtils.removeSearchFromUrl(t)).split("/");return`https://player.vimeo.com/video/${e[e.length-1]}`}if(/https:\/\/www\.youtube\.com\/watch\?.*v=.*/.test(c)){const e=null===(i=s.queryString.parseUrl(t))||void 0===i?void 0:i.query;let o=`https://www.youtube.com/embed/${null==e?void 0:e.v}`;null==e||delete e.v;const r=Object.keys(e);return(null==r?void 0:r.length)>0&&r.forEach((t,s)=>{o=`${o}${0===s?"?":"&"}${t}=${e[t]}`}),o}if(/https:\/\/youtu\.be\/.*/.test(c)){const e=(t=s.urlUtils.removeSearchFromUrl(t)).split("/");return`https://www.youtube.com/embed/${e[e.length-1]}`}if(/https:\/\/www\.facebook\.com\/.*\/videos\/.*/.test(c))return`https://www.facebook.com/plugins/video.php?href=${c}&show_text=0`;l===e.Code&&t.startsWith("//")&&(t=`https:${t}`),this.checkURLFormat(t,o)||(t="about:blank");const d=[".maps.arcgis.com",".mapsdevext.arcgis.com",".mapsqa.arcgis.com"];let p="";t.includes("https://")&&(p=t.substring(8).split("/")[0]);let u=!1,h="";for(const e of d)if(p.includes(e)){switch(u=!0,e){case".maps.arcgis.com":h="prod";break;case".mapsdevext.arcgis.com":h="dev";break;case".mapsqa.arcgis.com":h="qa"}break}const m=window.jimuConfig.hostEnv;if(u&&h===m){const e=(0,s.getAppStore)().getState();if(e&&e.user){const s=null===(r=null==e?void 0:e.portalSelf)||void 0===r?void 0:r.urlKey,o=null===(n=null==e?void 0:e.portalSelf)||void 0===n?void 0:n.customBaseUrl;p&&s&&o&&(t=t.replace(p,`${s}.${o}`))}}return t},this.checkURLFormat=(e,t)=>{if(!e||""===e){t||this.setState({isEmptyUrl:!0});const{config:e}=this.props,{enableBlankMessage:s,blankMessage:o}=e,i=this.errMessages.unSupportUrl,r=s&&o||i;return t||this.setState({errMessage:r}),!1}if("about:blank"===e)return!1;if(!new RegExp("^(([h][t]{2}[p][s])?://)").test(e))return t||this.setState({errMessage:this.errMessages.httpsCheck}),!1;if(new RegExp("^(([h][t]{2}[p][s])?://localhost)").test(e))return!0;const s=e.indexOf(".");return!(s<0||s===e.length-1)||(t||this.setState({errMessage:this.errMessages.unSupportUrl}),!1)},this.formatMessage=e=>this.props.intl.formatMessage({id:e,defaultMessage:l[e]}),this.reload=()=>{const{useSrcdoc:t}=this.state,{config:s}=this.props;if(this.ifr)if(s.embedType===e.Code&&t){const e=this.ifr.srcdoc;this.ifr.srcdoc=e}else{const e=this.ifr.src;this.ifr.src=e}},this.loadContent=()=>{const{config:t}=this.props,{content:s,useSrcdoc:o}=this.state,{embedType:i}=t;this.ifr&&(this.ifr.removeAttribute("srcdoc"),this.ifr.removeAttribute("src"),i===e.Code&&o?this.ifr.srcdoc=s:setTimeout(()=>{this.ifr&&(this.ifr.src=this.processUrl(s))},100))},this.onHtmlResolved=(e,t)=>{const s=e.replace(/(^\s*|\s*$)/g,"");this.setState({contentLabel:s,content:s,resolveErr:t})},this.getIframe=(e,o,i,r=!1)=>{const{id:n,a11yLabel:a}=this.props,l=a||this.formatMessage("embedHint"),c=r?{sandbox:"allow-scripts allow-same-origin allow-forms allow-popups allow-presentation allow-popups-to-escape-sandbox"}:{};return(0,t.jsx)("iframe",Object.assign({id:`${s.WIDGET_PREFIX_FOR_A11Y_SKIP}${n}`,title:l,className:`iframe-${n} ${!e&&"w-100"} ${!o&&"h-100"} embed-iframe`},c,{allowFullScreen:!0,onLoad:this.iframeOnLoad,ref:e=>{this.ifr=e},allow:"local-network-access; geolocation","data-testid":"embedSandbox"},i))};const{config:i}=o,{embedType:r,embedCode:n,expression:a}=i;this.errMessages={httpsCheck:this.formatMessage("httpsUrlMessage"),unSupportUrl:this.formatMessage("unSupportUrl"),unSupportIframeUrl:this.formatMessage("unSupportIframeUrl")},this.checkUrl=this.checkUrl.bind(this);const c=m(n),d=c||f.sanitize(n),p={content:r===e.Url?a:d,contentLabel:"",isLoading:!1,loadErr:!1,resolveErr:!1,errMessage:"",isEmptyUrl:!1,codeLimitExceeded:!1,useSrcdoc:!c};this.state=p,this.shouldRenderIframeInView=!1}componentDidMount(){const{config:t}=this.props,{content:s}=this.state;s&&s.trim().length>0&&this.setState({isLoading:!0},()=>{t.embedType===e.Code&&this.loadContent()})}componentDidUpdate(t,o){var i,r,n,a;const{content:l,isEmptyUrl:c}=this.state,{content:d}=o,{appMode:p,config:u,id:h,theme:v}=this.props,{embedCode:g,embedType:b,enableBlankMessage:w,blankMessage:x,autoRefresh:y,autoInterval:S,expression:I,honorThemeFont:U}=u,{config:T,appMode:M,sectionNavInfos:k,theme:E}=t,{enableBlankMessage:L,blankMessage:C,autoRefresh:j,autoInterval:$,embedType:P,honorThemeFont:R}=T,A=y!==j||S!==$,F=(null===(r=null===(i=this.props)||void 0===i?void 0:i.stateProps)||void 0===r?void 0:r.codeLimitExceeded)||!1,_=b===e.Code;this.setState({codeLimitExceeded:F}),(p!==M&&p===s.AppMode.Design||A)&&this.reload();const N=m(g),V=N||f.sanitize(g);if(b!==P){const t=b===e.Url?I:V;this.setState({loadErr:!1,errMessage:"",isEmptyUrl:!1,resolveErr:!1,codeLimitExceeded:!1,content:t,useSrcdoc:!N}),this.props.dispatch(s.appActions.widgetStatePropChange(h,"codeLimitExceeded",!1))}else _?T.embedCode!==g&&this.setState({content:V,useSrcdoc:!N}):T.expression!==I&&this.setState({content:I,useSrcdoc:!N});if(c){if(x!==C||w!==L){const e=this.errMessages.unSupportUrl,t=w&&x||e;this.setState({errMessage:t})}}if(l!==d&&this.setState({isLoading:!!l,loadErr:!1},()=>{this.checkAndLoadByType()}),this.reloadContentInView(k),this.autoRefreshHandler(A),_&&!N){const e=null===(n=v.ref.typeface)||void 0===n?void 0:n.fontFamily,t=(null===(a=E.typography)||void 0===a?void 0:a.fontFamilyBase)!==e;R!==U&&(U?e&&this.updateIframeFont(e):this.removeIframeFont()),t&&U&&e&&this.updateIframeFont(e)}}checkUrl(e){return this.checkURLFormat(e)?(this.setState({loadErr:!1}),Promise.resolve(!0)):(this.setState({loadErr:!0}),Promise.resolve(!1))}isOriginSameAsLocation(e){const t=window.location,s=/(\w+:)?(?:\/\/)([\w.-]+)?(?::(\d+))?\/?/.exec(e)||[],o={protocol:s[1]||"",host:s[2]||"",port:s[3]||""};let i="";for(const e of v)if(t.host.includes(e)){i=e;break}if(s[2].includes(i))return!0;const r=e=>e.port||{"http:":80,"https:":443}[e.protocol||t.protocol];return!!(o.protocol&&o.protocol===t.protocol&&o.host&&o.host===t.host&&o.host&&r(o)===r(t))}render(){const{isLoading:n,loadErr:a,errMessage:l,resolveErr:c,content:p,contentLabel:u,codeLimitExceeded:h,useSrcdoc:m}=this.state,{theme:f,id:v,config:g}=this.props,{embedCode:b,embedType:w,expression:x,enableLabel:y,label:S}=g;if(w===e.Code?!b:!x||"<p><br></p>"===x||"<p></p>"===x)return(0,t.jsxs)(o.Fragment,{children:[(0,t.jsx)(i.WidgetPlaceholder,{icon:d(),name:this.formatMessage("_widgetLabel"),message:this.formatMessage("embedHint")}),h&&(0,t.jsx)("div",{className:"p-2 w-100",style:{position:"absolute",bottom:0},children:(0,t.jsx)(i.Alert,{withIcon:!0,size:"small",type:"warning",text:this.formatMessage("maxLimitTips"),className:"w-100"})})]});let I=!0;(w===e.Url||w===e.Code&&!m)&&(I=!this.checkSafeDomain(this.processUrl(p,!0)));let U={width:void 0,height:void 0};U=(e=>{const t=/<iframe\s+[^>]*width=['"]([^'"]+)[^>](.*)/gi.exec(e),s=/<iframe\s+[^>]*height=['"]([^'"]+)[^>](.*)/gi.exec(e);let o,i;return(null==t?void 0:t.length)>1&&(o=t[1]),(null==s?void 0:s.length)>1&&(i=s[1]),{width:o,height:i}})(b);const{width:T,height:M}=U;return(0,t.jsx)(s.ViewVisibilityContext.Consumer,{children:({isInView:d,isInCurrentView:p})=>{let m=!0;return this.shouldRenderIframeInView||(m=!d||p,m&&(this.shouldRenderIframeInView=!0)),this.needLoadContentInView=d&&p,(0,t.jsx)(o.Fragment,{children:m&&(0,t.jsxs)(i.Paper,{shape:"none",transparent:!0,className:"jimu-widget widget-embed",css:r(f,U),children:[this.getIframe(T,M,U,I),n&&(0,t.jsx)("div",{className:"jimu-secondary-loading"}),!c&&a&&(0,t.jsx)("div",{className:"mask text-center load-err-mask",children:(0,t.jsxs)("div",{className:"mask-content",children:[(0,t.jsx)(i.AlertButton,{variant:"text",type:"warning"}),(0,t.jsx)("div",{className:"mt-2",children:l})]})}),c&&(0,t.jsx)("div",{"data-testid":"test-expressionMask",className:"mask text-center load-err-mask",children:(0,t.jsx)("div",{className:(0,s.classNames)("mask-content",{"truncate-two":!(y&&S)}),style:{width:"70%"},title:y&&S||u,children:y&&S||u})}),w===e.Url&&(0,t.jsx)(i.DynamicUrlResolver,{widgetId:v,useDataSources:this.props.useDataSources,value:g.expression,onHtmlResolved:this.onHtmlResolved}),h&&(0,t.jsx)("div",{className:"bottom-alert p-2 w-100",children:(0,t.jsx)(i.Alert,{withIcon:!0,size:"small",type:"warning",text:this.formatMessage("maxLimitTips"),className:"w-100"})})]})})}})}}g.versionManager=h,g.mapExtraStateProps=(e,t)=>{var s,o;return{appMode:null===(s=null==e?void 0:e.appRuntimeInfo)||void 0===s?void 0:s.appMode,sectionNavInfos:null===(o=null==e?void 0:e.appRuntimeInfo)||void 0===o?void 0:o.sectionNavInfos}};const b=g;function w(e){n.p=e}})(),a})())}}});